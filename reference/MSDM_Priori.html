<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create spatial predictor variables to reduce overprediction of species distribution models — MSDM_Priori • MSDM</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create spatial predictor variables to reduce overprediction of species distribution models — MSDM_Priori" />
<meta property="og:description" content="This function creates rasters that, together with environmental variables, can be used to construct constrained species distribution models spatial" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sjevelazco/MSDM/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create spatial predictor variables to reduce overprediction of species distribution models</h1>
    <small class="dont-index">Source: <a href='https://github.com/sjevelazco/MSDM/blob/master/R/MSDM_Priori.R'><code>R/MSDM_Priori.R</code></a></small>
    <div class="hidden name"><code>MSDM_Priori.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates rasters that, together with environmental variables, can be used to construct constrained species distribution models spatial</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>MSDM_Priori</span><span class='op'>(</span>
  <span class='va'>records</span>,
  x <span class='op'>=</span> <span class='cn'>NA</span>,
  y <span class='op'>=</span> <span class='cn'>NA</span>,
  sp <span class='op'>=</span> <span class='cn'>NA</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"XY"</span>, <span class='st'>"MIN"</span>, <span class='st'>"CML"</span>, <span class='st'>"KER"</span><span class='op'>)</span>,
  rasterlayer <span class='op'>=</span> <span class='cn'>NULL</span>,
  dirsave <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>records</th>
      <td><p>data.frame. A database with geographical coordinates of species presences used to create species distribution models.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>character. Column name with longitude values.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>character. Column name with latitude values.</p></td>
    </tr>
    <tr>
      <th>sp</th>
      <td><p>character. Column name with species names.  It would be desirable that the species names are as simple as possible and with no space between the genus and the specific epithet (e.g. Alchornea_glandulosa).
Do not use author names, symbols or accents. For example, substitute names like Senna chacoensis (L.Bravo) H.S.Irwin &amp; Barneby or Erythrina crista-galli L., for Senna_chacoensis and Erythrina_cristagalli. It is mandatory that the species names and the raster are the same.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character. A character string indicating which MSDM the method that must be used. The next methods are available: XY, MIN, CML, and KER. Usage method = 'CML'</p></td>
    </tr>
    <tr>
      <th>rasterlayer</th>
      <td><p>raster object. A raster, stack, or brick object that will be used to construct species distribution models. This object will be used as a basis for creating MSDM variables with the same resolution, extent, and pattern of empty cells that the environmental variables. It is advisable to use a raster of an environmental layer that will be used in the future to create the species distribution models in order not to have problems (e.g. resolution, extent, cells with NA) between environmental and constraining raster.</p></td>
    </tr>
    <tr>
      <th>dirsave</th>
      <td><p>character. A character string indicating the directory where result must be saved.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function save raster files (with geotiff format) in a folder named with the MSDM method. Such raster/s have to be used as covariate together with environmental variables at the moment to construct species distribution models. A pair of raster layers are created for all species set for XY method; on the contrary, CML, MIN, and KER create a species-specific raster layer.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>XY (Latlong method). It assumes that spatial structure can partially explain species distribution (Bahn &amp; Mcgill, 2007). Two raster layers will be created, containing the latitude and longitude of pixels in decimal degrees, respectively. These raster layers should be included as covariates with the environmental layers to construct species distribution models.</p>

<p>MIN (Nearest neighbour distance). Compiled and adapted from Allouche et al. (2008), this method calculates for each cel the Euclidian geographic distance to the nearest presence point.</p>

<p>CML (Cumulative distance method). Compiled and adapted from Allouche et al. (2008), it assumes that pixels closer to presences are likely included in species distributions. A raster layer will be created containing the sum of Euclidian geographic distances from each pixel to all occurrences of a species. Obtained values are normalized to vary from zero to one. This raster layer should be included as covariates with the environmental layers to construct species distribution models.</p>

<p>KER (Kernel method). Also compiled and adapted from Allouche et al. (2008), this method, like CML, assumes that pixels located in areas with a higher density of occurrences are likely included in the actual species distribution. A raster layer will be created containing the Gaussian values based on the density of occurrences of a species. Standard deviation of the Gaussian distribution was the maximum value in a vector of minimum distances between pairs of occurrences of a species. Gaussian values are normalized to vary from zero to one. This raster layer should be included as covariates with the environmental layers to construct species distribution models.</p>

<p>Further methodological and performance information of these methods see Mendes et al. (2020).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Mendes, P.; Velazco S.J.E.; Andrade, A.F.A.; De Marco, P. (2020) Dealing with overprediction in species distribution models: how adding distance constraints can improve model accuracy, Ecological Modelling, in press. https://doi.org/10.1016/j.ecolmodel.2020.109180</p></li>
<li><p>Allouche, O.; Steinitz, O.; Rotem, D.; Rosenfeld, A.; Kadmon, R. (2008). Incorporating distance constraints into species distribution models. Journal of Applied Ecology, 45(2), 599-609. doi:10.1111/j.1365-2664.2007.01445.x</p></li>
<li><p>Bahn, V.; Mcgill, B. J. (2007). Can niche-based distribution models outperform spatial interpolation? Global Ecology and Biogeography, 16(6), 733-742. doi:10.1111/j.1466-8238.2007.00331.x</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='MSDM_Posteriori.html'>MSDM_Posteriori</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://sjevelazco.github.io/MSDM'>MSDM</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Raster data and a data.frame with occurrences will be loaded</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"sp_sdm"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"occurrences"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/headtail.html'>head</a></span><span class='op'>(</span><span class='va'>occurrences</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     sp          x        y</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 SP01  -87.54180 13.95804</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 SP01 -103.54173 21.29134</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3 SP01 -101.87507 20.95801</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 SP01  -99.70841 24.87466</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5 SP01 -100.37508 30.29131</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6 SP01 -100.20841 20.70801</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Some changes will be done on sp_sdm object to be used as example</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>sp_sdm</span><span class='op'>)</span></span>
<span class='r-plt'><img src='MSDM_Priori-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>sp_sdm</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "RasterBrick"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"package")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "raster"</span>
<span class='r-in'><span class='va'>sp_sdm</span> <span class='op'>&lt;-</span> <span class='va'>sp_sdm</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='co'># a layer of this RasterBrick will be selected</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>sp_sdm</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "RasterLayer"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> attr(,"package")</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "raster"</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>sp_sdm</span><span class='op'>)</span></span>
<span class='r-plt'><img src='MSDM_Priori-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>tmdir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>tmdir</span> <span class='co'># temporal directory where will be saves raster layers</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZ2N3Iu"</span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>MSDM_Priori</span><span class='op'>(</span>records <span class='op'>=</span> <span class='va'>occurrences</span>,</span>
<span class='r-in'>            x <span class='op'>=</span> <span class='st'>"x"</span>, y <span class='op'>=</span> <span class='st'>"y"</span>, sp <span class='op'>=</span> <span class='st'>"sp"</span>, method <span class='op'>=</span> <span class='st'>"XY"</span>,</span>
<span class='r-in'>            rasterlayer <span class='op'>=</span> <span class='va'>sp_sdm</span>, dirsave <span class='op'>=</span> <span class='va'>tmdir</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>NOT UPDATED FOR PROJ &gt;= 6</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>NOT UPDATED FOR PROJ &gt;= 6</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> results are in: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZ2N3Iu/MSDM_XY </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># open directory were raster were saved</span></span>
<span class='r-in'><span class='va'>rdir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>tmdir</span>, <span class='st'>"MSDM_XY"</span>, sep <span class='op'>=</span> <span class='st'>'/'</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>rdir</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZ2N3Iu/MSDM_XY"</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># plot results</span></span>
<span class='r-in'><span class='va'>new_var</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>rdir</span>, pattern <span class='op'>=</span> <span class='st'>".tif"</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>new_var</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/stack.html'>stack</a></span><span class='op'>(</span><span class='va'>new_var</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>new_var</span><span class='op'>)</span></span>
<span class='r-plt'><img src='MSDM_Priori-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># CML method----</span></span>
<span class='r-in'><span class='fu'>MSDM_Priori</span><span class='op'>(</span>records <span class='op'>=</span> <span class='va'>occurrences</span>,</span>
<span class='r-in'>            x <span class='op'>=</span> <span class='st'>"x"</span>, y <span class='op'>=</span> <span class='st'>"y"</span>, sp <span class='op'>=</span> <span class='st'>"sp"</span>, method <span class='op'>=</span> <span class='st'>"CML"</span>,</span>
<span class='r-in'>            rasterlayer <span class='op'>=</span> <span class='va'>sp_sdm</span>, dirsave <span class='op'>=</span> <span class='va'>tmdir</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> results are in: </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZ2N3Iu/MSDM_CML </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># open directory were raster were saved</span></span>
<span class='r-in'><span class='va'>rdir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>tmdir</span>, <span class='st'>"MSDM_CML"</span>, sep <span class='op'>=</span> <span class='st'>'/'</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>rdir</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpZ2N3Iu/MSDM_CML"</span>
<span class='r-in'><span class='co'># shell.exec(rdir)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># plot results</span></span>
<span class='r-in'><span class='va'>new_var</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>rdir</span>, pattern <span class='op'>=</span> <span class='st'>".tif"</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>new_var</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/stack.html'>stack</a></span><span class='op'>(</span><span class='va'>new_var</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>new_var</span><span class='op'>)</span></span>
<span class='r-plt'><img src='MSDM_Priori-4.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='co'># Note that a raster is created for each species</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Poliana Mendes, Santiago J.E. Velazco, Andre F.A. Andrade, Paulo De Marco .</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


